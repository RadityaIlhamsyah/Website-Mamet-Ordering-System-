{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from 'jose';\nimport { cookies } from 'next/headers';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\nconst secret = new TextEncoder().encode(JWT_SECRET);\n\nexport interface SessionPayload {\n  username: string;\n  email: string;\n  expiresAt: Date;\n}\n\nexport async function createSession(username: string, email: string) {\n  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000); // 7 days\n  \n  const token = await new SignJWT({ username, email })\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('7d')\n    .sign(secret);\n\n  const cookieStore = await cookies();\n  cookieStore.set('session', token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    expires: expiresAt,\n    sameSite: 'lax',\n    path: '/',\n  });\n\n  return token;\n}\n\nexport async function verifySession(): Promise<SessionPayload | null> {\n  const cookieStore = await cookies();\n  const token = cookieStore.get('session')?.value;\n\n  if (!token) {\n    return null;\n  }\n\n  try {\n    const verified = await jwtVerify(token, secret);\n    return {\n      username: verified.payload.username as string,\n      email: verified.payload.email as string,\n      expiresAt: new Date((verified.payload.exp || 0) * 1000),\n    };\n  } catch (error) {\n    console.error('[v0] Session verification failed:', error);\n    return null;\n  }\n}\n\nexport async function deleteSession() {\n  const cookieStore = await cookies();\n  cookieStore.delete('session');\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;AAAA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC;AAQjC,eAAe,cAAc,QAAgB,EAAE,KAAa;IACjE,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK,OAAO,SAAS;IAE3E,MAAM,QAAQ,MAAM,IAAI,wKAAO,CAAC;QAAE;QAAU;IAAM,GAC/C,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC;IAER,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,YAAY,GAAG,CAAC,WAAW,OAAO;QAChC,UAAU;QACV,QAAQ,oDAAyB;QACjC,SAAS;QACT,UAAU;QACV,MAAM;IACR;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,YAAY;IAE1C,IAAI,CAAC,OAAO;QACV,OAAO;IACT;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,4KAAS,EAAC,OAAO;QACxC,OAAO;YACL,UAAU,SAAS,OAAO,CAAC,QAAQ;YACnC,OAAO,SAAS,OAAO,CAAC,KAAK;YAC7B,WAAW,IAAI,KAAK,CAAC,SAAS,OAAO,CAAC,GAAG,IAAI,CAAC,IAAI;QACpD;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport type { NextRequest } from \"next/server\"\nimport { verifySession } from \"./lib/auth\"\n\nexport async function middleware(request: NextRequest) {\n  const { pathname } = request.nextUrl\n\n  // 1. Check if user is trying to access admin routes\n  if (pathname.startsWith(\"/admin\")) {\n    const session = await verifySession()\n\n    // 2. If user is on the login page and ALREADY has a session, redirect to dashboard\n    if (pathname === \"/admin/login\" && session) {\n      return NextResponse.redirect(new URL(\"/admin\", request.url))\n    }\n\n    // 3. If user is accessing protected admin pages (NOT login) and has NO session, redirect to login\n    if (pathname !== \"/admin/login\" && !session) {\n      return NextResponse.redirect(new URL(\"/admin/login\", request.url))\n    }\n  }\n\n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\"/admin/:path*\"],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,oDAAoD;IACpD,IAAI,SAAS,UAAU,CAAC,WAAW;QACjC,MAAM,UAAU,MAAM,IAAA,oIAAa;QAEnC,mFAAmF;QACnF,IAAI,aAAa,kBAAkB,SAAS;YAC1C,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,kGAAkG;QAClG,IAAI,aAAa,kBAAkB,CAAC,SAAS;YAC3C,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,gBAAgB,QAAQ,GAAG;QAClE;IACF;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAgB;AAC5B"}}]
}